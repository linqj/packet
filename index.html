<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="applicable-device" content="mobile" />
    <meta name="referrer" content="always" />
    <meta
      name="viewport"
      content="width=device-width, height=device-height, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"
    />
    <title>除夕咻红包</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0 auto;
        -webkit-tap-highlight-color: transparent;
      }
      .app {
        width: 100%;
        overflow: hidden;
        height: 100%;
        background: #e4f1ff;
        background: url("./images/background.jpg") no-repeat;
        background-size: cover;
        background-position: center;
      }
      .text-des {
        width: 90%;
        height: auto;
        display: block;
        margin: 0 auto;
      }
      .package {
        width: 100%;
        height: 100%;
      }
      text {
        font-weight: 700;
        text-anchor: middle;
        pointer-events: auto;
        dominant-baseline: middle;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <audio
        src="./xiu.mp3"
        id="myaudio"
        controls="controls"
        hidden="true"
        preload="load"
      ></audio>
      <div></div>
      <svg
        style="width:100%;height:100%;"
        xmlns="http://www.w3.org/2000/svg"
        id="mySVG"
        viewBox="0 0 100% 100%"
        preserveAspectRatio="xMidYMid meet"
      >
        <g  id="startImg" display="block">
          <image
            xlink:href="./images/start_text.png"
            x="7%"
            y="22%"
            display="block"
            width="86%"
            height="105"
          ></image>
          <image
          xlink:href="./images/start_button.png"
          x="33%"
            y="50%"
          display="block"
          width="34%"
          height="60"
          onclick="startGame()"
          id="startButton"
        ></image>
        </g>
        <g id="circleButton"  display="none">
            <image
        xlink:href="./images/draw_text.png"
        x="4.5%"
        y="22%"
        display="block"
        width="86%"
        height="105"
      >
    </image>
          <image
          transform="translate(-40,-38)"
            xlink:href="./images/xiu_button.png"
            x="50%"
            y="53%"
            width="80"
            height="80"
            onclick="showPackage()"
          />
          <!-- 第一条虚线 -->
          <circle
            cx="50%"
            cy="53%"
            r="40"
            fill="none"
            stroke="#ffe405"
            stroke-width="2"
            opacity="0.9"
          >
            <animate
              attributeName="r"
              from="40"
              to="52"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
            <animate
              attributeName="opacity"
              from="0.9"
              to="0"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
          </circle>
          <!-- 第二条虚线 -->
          <circle
            cx="50%"
            cy="53%"
            r="46"
            fill="none"
            stroke="#ffe405"
            stroke-width="1.8"
            opacity="0.6"
          >
            <animate
              attributeName="r"
              from="46"
              to="54"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
            <animate
              attributeName="opacity"
              from="0.6"
              to="0"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
          </circle>
          <!-- 第3条虚线 -->
          <circle
            cx="50%"
            cy="53%"
            r="50"
            fill="none"
            stroke="#ffe405"
            stroke-width="1.5"
            opacity="0.3"
          >
            <animate
              attributeName="r"
              from="50"
              to="58"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
            <animate
              attributeName="opacity"
              from="0.3"
              to="0"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
          </circle>
          <!-- 第4条虚线 -->
          <circle
            cx="50%"
            cy="53%"
            r="58"
            fill="none"
            stroke="#ffe405"
            stroke-width="1.5"
            opacity="0.1"
          >
            <animate
              attributeName="r"
              from="58"
              to="64"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
            <animate
              attributeName="opacity"
              from="0.1"
              to="0"
              begin="0s"
              dur="1s"
              repeatCount="indefinite"
            />
          </circle>
          <text
          x="50%"
          y="64%"
          fill="#905983"
          font-size="14"
          dominant-baseline="text-before-edge"
          opacity="0"
        >
          请快速连续点击“咻”按键
          <animate
            attributeName="opacity"
            from="0"
            to="1"
            begin="startButton.click"
            dur="1s"
            fill="freeze"
          />
        </text>
        </g>
        <g id="parent" display="none">
          <rect
            x="0"
            y="0"
            opacity="0.5"
            height="100%"
            width="100%"
            fill="#000000"
          />
          <image
            xlink:href="./images/result_text.png"
            x="2%"
            y="5%"
            width="90%"
            height="300"
          />
          <image
            xlink:href="./images/button_background.png"
            x="7%"
            y="45%"
            width="86%"
            height="200"
          />
          <image
            xlink:href="./images/draw_button.png"
            x="30%"
            y="57%"
            width="40%"
            height="70"
            onclick="goToActive()"
          />
        </g>
        <g id="loading" display="none">
          <rect
            x="0"
            y="0"
            opacity="0.5"
            height="100%"
            width="100%"
            fill="#000000"
          ></rect>
          <image
            xlink:href="./images/lailai.gif"
            x="10%"
            y="180"
            width="80%"
            height="250"
          />
        </g>
      </svg>
    </div>
    <script>
      var myAuto = document.getElementById("myaudio");
      var num = 0;
      var oldTime = null;
      var isStart = false;
      var svgDoc = document.getElementById("parent");
      var circleButton = document.getElementById("circleButton");
      var loading = document.getElementById("loading");
      var startButton = document.getElementById("startButton");
      var drawImg = document.getElementById("drawImg");
      var startImg = document.getElementById("startImg");
      function startGame() {
        isStart = true;
        //缓存音乐
        // myAuto.setAttribute('src','xiu.mp3');
        myAuto.play();
        myAuto.pause();
        // let child =
        //   '<text x="50%" y="55.5%" id="runButton" onclick="showPackage()" fill="#d12e1b" font-size="38" dominant-baseline=text-before-edge>咻</text>';
        // startButton.innerHTML = child;
        setTimeout(function() {
          circleButton.setAttribute("display", "block");
            }, 500);
        startImg.setAttribute("display", "none");
      }
      function showPackage() {
        //判断是否已经点击了开始游戏，不然不允许进行咻一咻
        if (isStart) {
          myAuto.play();
          if (num != 3) {
            num = num + 1;
          } else if (num == 3) {
            setTimeout(function() {
              svgDoc.setAttribute("display", "block");
              circleButton.innerHTML = "";
              startButton.innerHTML = "";
              startImg.innerHTML = "";
            }, 1000);
          }
        }
      }
      function goToActive() {
        loading.setAttribute("display", "block");
        // uat 链接 ：http://jdt-uat.e-hqins.com/sit/jdt/demolition
        // prd 链接 :  http://agcy.e-hqins.com/sit/jdt/demolition
        window.location.href = "http://jdt-uat.e-hqins.com/sit/jdt/demolition";
      }
    </script>
  </body>
</html>
